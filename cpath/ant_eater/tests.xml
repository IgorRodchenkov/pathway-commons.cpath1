<?xml version="1.0"?>

<project name="Anteater-test" default="report">
  <taskdef resource="META-INF/Anteater.tasks"/>
  <typedef resource="META-INF/Anteater.types"/>

  <property name="base_url"
        value="http://www.cbio.mskcc.org/cpath"/>

  <property name="cpath_home"
      value="${base_url}/index.jsp"/>

  <target name="prepare">
    <delete dir="logs"/>
    <delete dir="reports"/>
    <mkdir dir="logs"/>
    <mkdir dir="reports"/>
  </target>

  <target name="check-website">
    <echo>Now downloading and testing: ${cpath_home}</echo>

    <group id="cpath_pages">
        <logger type="xml"/>
        <logger type="color"/>
        <property name="haltonerror" value="false"/>
    </group>

    <group id="cpath_search">
        <logger type="xml"/>
        <logger type="color"/>
        <property name="haltonerror" value="false"/>
    </group>

    <group id="cpath_web_service_api">
        <logger type="xml"/>
        <logger type="color"/>
        <property name="haltonerror" value="false"/>
    </group>

    <httpRequest group="cpath_pages" href="${cpath_home}"
        description="Validate Home Page">
           <match>
            <regexp>cancer pathway database</regexp>
          </match>
    </httpRequest>

    <httpRequest group="cpath_pages" href="${base_url}/browse.do"
        description="Validate Browse By Organism">
        <match>
            <regexp>Homo sapiens</regexp>
            <regexp>Mus musculus</regexp>
        </match>
    </httpRequest>

    <httpRequest group="cpath_pages" href="${base_url}/dbStats.do"
        description="Validate Database Stats">
      <match>
          <regexp>Number of Interactions</regexp>
          <regexp>Number of Interactors</regexp>
      </match>
    </httpRequest>

    <httpRequest group="cpath_pages" href="${base_url}/cytoscape.do"
        description="Validate Cytoscape PlugIn Page">
      <match>
          <regexp>Cytoscape PlugIn</regexp>
      </match>
    </httpRequest>

    <httpRequest group="cpath_search"
        href="${base_url}/webservice.do?version=1.0&amp;q=dna+repair&amp;format=html&amp;organism=&amp;cmd=get_by_keyword"
        description="Validate Interaction View with Regular Text Search">
      <match>
          <regexp>DNA repair protein</regexp>
      </match>
    </httpRequest>

    <httpRequest group="cpath_search"
        href="${base_url}/webservice.do?version=1.0&amp;cmd=get_by_keyword&amp;format=html&amp;startIndex=0&amp;organism=9606&amp;maxHits=10"
        description="Validate Interaction View, Browse By Organism">
      <match>
          <regexp>Homo sapiens</regexp>
          <regexp>PMID</regexp>
      </match>
    </httpRequest>

    <httpRequest group="cpath_search"
          href="${base_url}/webservice.do?version=1.0&amp;cmd=get_by_keyword&amp;q=interactor_id%3A307&amp;format=html&amp;startIndex=0&amp;organism=&amp;maxHits=10"
          description="Validate Protein View">
        <match>
            <regexp>DNA repair protein RAD51 homolog 1</regexp>
            <regexp>InterPro</regexp>
            <regexp>UniProt</regexp>
            <regexp>Homo sapiens</regexp>
        </match>
      </httpRequest>

    <httpRequest group="cpath_web_service_api"
        href="${base_url}/webservice.do?version=1.0&amp;cmd=get_by_keyword&amp;q=&amp;format=xml&amp;startIndex=0&amp;organism=9606&amp;maxHits=10"
        description="Validate XML Web Services API">
      <match>
          <regexp>Tyrosine-protein kinase LYN</regexp>
       </match>
    </httpRequest>
    </target>

    <target name="report" depends="prepare, check-website">
        <ant antfile="${anteater.report}">
            <property name="style.dir" value="stylesheetsxx"/>
            <property name="report.dir" value="reports"/>
        </ant>
    </target>
</project>